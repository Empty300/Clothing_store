{% extends 'store/base.html' %}
{% load static %}
{% block content %}
            {% if product.category.name == 'Black' %}
                <link rel="stylesheet" href="{% static 'css/style_black.css' %}">
            {% endif %}

            <div id="page-content">   
                <!--Breadcrumbs-->
                <div class="breadcrumbs-wrapper text-uppercase">
                    <div class="container">
                        <div class="breadcrumbs"><a href="https://template.annimexweb.com/optimal/index.html" title="Back to the home page">Home</a><span>|</span><span class="fw-bold">Product Layout Style1</span></div>
                    </div>
                </div>
                <!--End Breadcrumbs-->

                <!--Main Content-->
                <div class="container">
                    <!--Product Content-->
                    <div class="product-single">
                        <div class="row">
                            <div class="col-lg-7 col-md-6 col-sm-12 col-12">
                                <div class="product-details-img thumb-left clearfix d-flex-wrap mb-3 mb-md-0">
                                    <div class="product-thumb">
                                        <div id="gallery" class="product-dec-slider-2 product-tab-left">
                                            <a data-image="{{product.image1.url}}" data-zoom-image="{{product.image1.url}}" class="slick-slide slick-cloned active">
                                                <img class="blur-up lazyload" data-src="{{product.image1.url}}" src="{{product.image1.url}}" alt="product" />
                                            </a>
                                            {% if product.image2 %}
                                            <a data-image="{{product.image2.url}}" data-zoom-image="{{product.image2.url}}" class="slick-slide slick-cloned">
                                                <img class="blur-up lazyload" data-src="{{product.image2.url}}" src="{{product.image2.url}}" alt="product" />
                                            </a>
                                            {% endif %}
                                            {% if product.image3 %}
                                            <a data-image="{{product.image3.url}}" data-zoom-image="{{product.image3.url}}" class="slick-slide slick-cloned">
                                                <img class="blur-up lazyload" data-src="{{product.image3.url}}" src={{product.image3.url}} alt="product" />
                                            </a>
                                            {% endif %}
                                            {% if product.image4 %}
                                            <a data-image="{{product.image4.url}}" data-zoom-image="{{product.image4.url}}" class="slick-slide slick-cloned">
                                                <img class="blur-up lazyload" data-src="{{product.image4.url}}" src={{product.image4.url}} alt="product" />
                                            </a>
                                            {% endif %}
                                            {% if product.image5 %}
                                            <a data-image="{{product.image5.url}}" data-zoom-image="{{product.image5.url}}" class="slick-slide slick-cloned">
                                                <img class="blur-up lazyload" data-src="{{product.image5url}}" src={{product.image5.url}} alt="product" />
                                            </a>
                                            {% endif %}
                                        </div>
                                    </div>
                                    <div class="zoompro-wrap product-zoom-right">
                                        <div class="zoompro-span"><img id="zoompro" class="zoompro" src="{{product.image1.url}}" data-zoom-image="{{product.image1.url}}" alt="product" /></div>
                                    </div>

                                </div>
                            </div>

                            <div class="col-lg-5 col-md-6 col-sm-12 col-12">
                                <!-- Product Info -->
                                <div class="product-single__meta">
                                    <h1 class="product-single__title">{{ product.name }}</h1>
                                    <div class="product-single__subtitle">Мужская</div>
                                    <!-- Product Info -->
                                    <div class="product-info">
                                        <p class="product-type">Производитель: <span>Текст</span></p>
                                        <p class="product-type">Модель: <span>Текст</span></p>
                                    </div>
                                    <!-- End Product Info -->
                                    <!-- Product Price -->
                                    <div class="product-single__price pb-1">
                                        <span class="visually-hidden">Regular price</span>
                                        <span class="product-price__sale--single">
                                            <span class="product-price__price product-price__sale">{{product.price}} РУБ.</span>

                                        </span>

                                    </div>
                                    <!-- End Product Price -->
                                    <!-- Countdown -->
                                    <!-- End Countdown -->
                                    <!-- Product Sold -->
                                    <!-- End Product Sold -->
                                </div>
                                <!-- End Product Info -->
                                <!-- Product Form -->
                                <form method="post" action="{% url 'store:basket_add' product.id %}" class="product-form hidedropdown">
                                    {% csrf_token %}
                                    <div class="swatch clearfix swatch-1 option2" data-option-index="1">
                                        <div class="product-form__item">
                                            <label class="label d-flex">Размер:<span class="required d-none">*</span><span class="slVariant ms-1 fw-bold"></span></label>
                                            <ul name="Size" class="swatches-size d-flex-center list-unstyled clearfix">
                                              {% if product.quantity_s %}
                                                <li data-value="S" type="number" value="S" class="swatch-element s available active">
                                                    <label name="Size" class="swatchLbl rounded medium" title="S">S</label>
                                                    <span class="tooltip-label">S</span>
                                                </li>
                                                {% else %}
                                                <li data-value="S" class="swatch-element s soldout">
                                                    <label class="swatchLbl rounded medium" title="S">S</label><span class="tooltip-label">S</span>
                                                </li>
                                                {% endif %}
                                                {% if product.quantity_m %}
                                                <li data-value="M" class="swatch-element s available">
                                                    <label class="swatchLbl rounded medium" title="M">M</label><span class="tooltip-label">M</span>

                                                </li>
                                                {% else %}
                                                <li data-value="M" class="swatch-element s soldout">
                                                    <label class="swatchLbl rounded medium" title="M">M</label><span class="tooltip-label">M</span>
                                                </li>
                                                {% endif %}
                                                {% if product.quantity_l %}
                                                <li data-value="L" class="swatch-element s available">
                                                    <label class="swatchLbl rounded medium" title="L">L</label><span class="tooltip-label">L</span>

                                                </li>
                                                {% else %}
                                                <li data-value="L" class="swatch-element l soldout">
                                                    <label class="swatchLbl rounded medium" title="L">L</label><span class="tooltip-label">L</span>
                                                </li>
                                                {% endif %}
                                                {% if product.quantity_xl %}
                                                <li data-value="XL" class="swatch-element s available">
                                                    <label class="swatchLbl rounded medium" title="XL">XL</label><span class="tooltip-label">XL</span>

                                                </li>
                                                {% else %}
                                                <li data-value="XL" class="swatch-element xl soldout">
                                                    <label class="swatchLbl rounded medium" title="XL">XL</label><span class="tooltip-label">XL</span>
                                                </li>
                                                {% endif %}
                                                {% if product.category.name == 'Black' %}

                                            <li class="ms-1"><a href="#sizechart" class="sizelink link-underline text-uppercase"><i class="icon an an-ruler d-none"></i> <font color="white">Таблица размеров</font></a></li>
                                                    {% else %}
                                                <li class="ms-1"><a href="#sizechart" class="sizelink link-underline text-uppercase"><i class="icon an an-ruler d-none"></i> Таблица размеров</a></li>
                                            {% endif %}
                                            </ul>
                                        </div>
                                    </div>
                                    <!-- End Swatches Size -->
                                    <!-- Product Action -->
                                    <div class="product-action w-100 clearfix">
                                        <div class="product-form__item--quantity d-flex-center mb-3">
                                            <div class="qtyField">
                                                <a class="qtyBtn minus" href="javascript:void(0);"><i class="icon an an-minus-r" aria-hidden="true"></i></a>
                                                <input type="text" name="Quantity" value="1" class="product-form__input qty">
                                                <a class="qtyBtn plus" href="javascript:void(0);"><i class="icon an an-plus-r" aria-hidden="true"></i></a>
                                            </div>

                                        </div>
                                        <div class="product-form__item--submit">
                                            <button type="submit" name="" class="btn rounded product-form__cart-submit"><span>Добавить в корзину</span></button>
                                        </div>
                                        <h3  rel="description">Описание</h3>
                            <div id="d" >
                                <div >
                                    <div class="row">
                                        <div class="col-12 col-sm-12 col-md-8 col-lg-8 mb-4 mb-md-0">
                                            <p>{{ product.description }}</p>

                                        </div>
                                    </div>
                                </div>
                            </div>
                                        <script>
                                           // Функция для получения CSRF-токена
function getCsrfToken() {
  var csrfToken = null;
  var cookies = document.cookie.split(';');
  for (var i = 0; i < cookies.length; i++) {
    var cookie = cookies[i].trim();
    if (cookie.substring(0, 10) === 'csrftoken=') {
      csrfToken = cookie.substring(10);
      break;
    }
  }
  return csrfToken;
}

// Функция для отправки POST-запроса на сервер
function addToCart() {
  var selectedSize = document.querySelector('.swatch-element.s.available.active label').textContent;
  var quantity = document.querySelector('.product-form__input.qty').value;
  var productId = '{{ product.id }}';
  var csrfToken = getCsrfToken();

  var xhr = new XMLHttpRequest();
  xhr.open("POST", "{% url 'store:basket_add' product.id %}", true);
  xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
  xhr.setRequestHeader('X-CSRFToken', csrfToken);
  xhr.onreadystatechange = function() {
    if (xhr.readyState === 4) {
      if (xhr.status === 200) {

        location.reload();
      } else {
        console.log('Ошибка при добавлении товара в корзину');
      }
    }
  };
  xhr.send('product_id=' + encodeURIComponent(productId) + '&Size=' + encodeURIComponent(selectedSize) + '&Quantity=' + encodeURIComponent(quantity));
}

// Обработчик события для кнопки "Добавить в корзину"
document.querySelector('.product-form__cart-submit').addEventListener('click', function(event) {
  event.preventDefault(); // отменяем стандартное поведение браузера
  addToCart(); // вызываем функцию отправки POST-запроса
});
                                        </script>
                                    </div>
                                    <!-- End Product Action -->


                            </div>
                         </div>
                    </form>
                        </div>
                    </div>
                    <!--Product Content-->


                    <!--Product Tabs-->

                </div>
                <!--End Container-->
            </div>
            <!--End Body Container-->






            <div class="modalOverly"></div>



            <!--Size Chart-->
            <div id="sizechart" class="mfpbox mfp-with-anim mfp-hide">
                <h4 class="fw-bold">Таблица размеров</h4>
                <p class="text-center">Это стандартизированная таблица, которая даст вам представление о том, какой размер вам понадобится.</p>
                <div class="table-responsive px-1">
                    <table class="table table-bordered align-middle">
                        <tbody>
                            <tr>
                                <th>Размер</th>
                                <th>XXS - XS</th>
                                <th>XS - S</th>
                                <th>S - M</th>
                                <th>M - L</th>
                                <th>L - XL</th>
                                <th>XL - XXL</th>
                            </tr>
                            <tr>
                                <td>UK</td>
                                <td>6</td>
                                <td>8</td>
                                <td>10</td>
                                <td>12</td>
                                <td>14</td>
                                <td>16</td>
                            </tr>
                            <tr>
                                <td>US</td>
                                <td>2</td>
                                <td>4</td>
                                <td>6</td>
                                <td>8</td>
                                <td>10</td>
                                <td>12</td>
                            </tr>
                            <tr>
                                <td>Italy (IT)</td>
                                <td>38</td>
                                <td>40</td>
                                <td>42</td>
                                <td>44</td>
                                <td>46</td>
                                <td>48</td>
                            </tr>
                            <tr>
                                <td>France (FR/EU)</td>
                                <td>34</td>
                                <td>36</td>
                                <td>38</td>
                                <td>40</td>
                                <td>42</td>
                                <td>44</td>
                            </tr>
                            <tr>
                                <td>Denmark</td>
                                <td>32</td>
                                <td>34</td>
                                <td>36</td>
                                <td>38</td>
                                <td>40</td>
                                <td>42</td>
                            </tr>
                            <tr>
                                <td>Russia</td>
                                <td>40</td>
                                <td>42</td>
                                <td>44</td>
                                <td>46</td>
                                <td>48</td>
                                <td>50</td>
                            </tr>
                            <tr>
                                <td>Germany</td>
                                <td>32</td>
                                <td>34</td>
                                <td>36</td>
                                <td>38</td>
                                <td>40</td>
                                <td>42</td>
                            </tr>
                            <tr>
                                <td>Japan</td>
                                <td>5</td>
                                <td>7</td>
                                <td>9</td>
                                <td>11</td>
                                <td>13</td>
                                <td>15</td>
                            </tr>
                            <tr>
                                <td>Australia</td>
                                <td>6</td>
                                <td>8</td>
                                <td>10</td>
                                <td>12</td>
                                <td>14</td>
                                <td>16</td>
                            </tr>
                            <tr>
                                <td>Korea</td>
                                <td>33</td>
                                <td>44</td>
                                <td>55</td>
                                <td>66</td>
                                <td>77</td>
                                <td>88</td>
                            </tr>
                            <tr>
                                <td>China</td>
                                <td>160/84</td>
                                <td>165/86</td>
                                <td>170/88</td>
                                <td>175/90</td>
                                <td>180/92</td>
                                <td>185/94</td>
                            </tr>
                            <tr>
                                <td><strong>Jeans</strong></td>
                                <td>24-25</td>
                                <td>26-27</td>
                                <td>27-28</td>
                                <td>29-30</td>
                                <td>31-32</td>
                                <td>32-33</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <button title="Close (Esc)" type="button" class="mfp-close">×</button>
            </div>
            <!--End Size Chart--






            <!-- Including Jquery -->
            <script src="{% static 'js/vendor/jquery-min.js' %}"></script>
            <script src="{% static 'js/vendor/js.cookie.js' %}"></script>
            <!--Including Javascript-->
            <script src="{% static 'js/plugins.js' %}"></script>
            <script src="{% static 'js/main.js' %}"></script>
            <!-- Photoswipe Gallery -->
            <script src="{% static 'js/vendor/photoswipe.min.js' %}"></script>
            <script>
                $(function () {
                    var $pswp = $('.pswp')[0],
                            image = [],
                            getItems = function () {
                                var items = [];
                                $('.lightboximages a').each(function () {
                                    var $href = $(this).attr('href'),
                                            $size = $(this).data('size').split('x'),
                                            item = {
                                                src: $href,
                                                w: $size[0],
                                                h: $size[1]
                                            };
                                    items.push(item);
                                });
                                return items;
                            };
                    var items = getItems();

                    $.each(items, function (index, value) {
                        image[index] = new Image();
                        image[index].src = value['src'];
                    });
                    $('.prlightbox').on('click', function (event) {
                        event.preventDefault();

                        var $index = $(".active-thumb").parent().attr('data-slick-index');
                        $index++;
                        $index = $index - 1;

                        var options = {
                            index: $index,
                            bgOpacity: 0.7,
                            showHideOpacity: true
                        };
                        var lightBox = new PhotoSwipe($pswp, PhotoSwipeUI_Default, items, options);
                        lightBox.init();
                    });
                });
            </script>
            <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
                <div class="pswp__bg"></div>
                <div class="pswp__scroll-wrap">
                    <div class="pswp__container">
                        <div class="pswp__item"></div>
                        <div class="pswp__item"></div>
                        <div class="pswp__item"></div>
                    </div>
                    <div class="pswp__ui pswp__ui--hidden">
                        <div class="pswp__top-bar">
                            <div class="pswp__counter"></div>
                            <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                            <button class="pswp__button pswp__button--share" title="Share"></button>
                            <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                            <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                            <div class="pswp__preloader">
                                <div class="pswp__preloader__icn">
                                    <div class="pswp__preloader__cut">
                                        <div class="pswp__preloader__donut"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                            <div class="pswp__share-tooltip"></div>
                        </div>
                        <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
                        <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>
                        <div class="pswp__caption"><div class="pswp__caption__center"></div></div>
                    </div>
                </div>
            </div>

        </div>
        <!--End Page Wrapper-->
    </body>

<!-- Mirrored from template.annimexweb.com/optimal/product-layout1.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 18 Jun 2022 19:55:28 GMT -->
</html>
{% endblock content %}